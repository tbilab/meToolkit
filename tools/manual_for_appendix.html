<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width">
<meta property="og:title" content="Phewas-Multimorbidity Explorer" />




<meta name="author" content="Nick Strayer" />

<meta name="date" content="2019-10-14" />

<meta name="description" content="Phewas-Multimorbidity Explorer">

<script id="pandoc-meta" type="application/json">
{"date":"2019-10-14","subtitle":"Usage Manual","output":{"pagedown::html_paged":{"self_contained":false,"toc":true}},"author":"Nick Strayer","title":"Phewas-Multimorbidity Explorer"}
</script>

<title>Phewas-Multimorbidity Explorer</title>


<link href="manual_for_appendix_files/paged-0.5/css/default-fonts.css" rel="stylesheet" />
<link href="manual_for_appendix_files/paged-0.5/css/default-page.css" rel="stylesheet" />
<link href="manual_for_appendix_files/paged-0.5/css/default.css" rel="stylesheet" />
<script src="manual_for_appendix_files/paged-0.5/js/config.js"></script>
<script src="manual_for_appendix_files/paged-0.5/js/paged.js"></script>
<script src="manual_for_appendix_files/paged-0.5/js/hooks.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



</head>

<body>

<div class="running-h1-title"></div>

<div class="running-h2-title"></div>



<div class="front-page">
<div id="header" class="title-page">
<h1 class="title">Phewas-Multimorbidity Explorer</h1>
<h1 class="subtitle"><span>Usage Manual</span></h1>
<h2 class="author">Nick Strayer</h2>
<h2 class="date">2019-10-14</h2>
</div>
</div>

<div class="front-matter-container">
<div id="TOC" class="level1 toc front-matter">
<ul>
<li><a href="#data"><span class="toc-section-number">1</span> Data</a><ul>
<li><a href="#individual-phenomes"><span class="toc-section-number">1.1</span> Individual phenomes</a></li>
<li><a href="#individual-snp-info"><span class="toc-section-number">1.2</span> Individual SNP info</a></li>
<li><a href="#phewas-results"><span class="toc-section-number">1.3</span> PheWas results</a></li>
<li><a href="#app-api"><span class="toc-section-number">1.4</span> App API</a></li>
<li><a href="#data-loading-screen"><span class="toc-section-number">1.5</span> Data Loading Screen</a></li>
<li><a href="#preloading-data"><span class="toc-section-number">1.6</span> Preloading data</a></li>
</ul></li>
<li><a href="#accessing-app"><span class="toc-section-number">2</span> Accessing app</a></li>
<li><a href="#main-app"><span class="toc-section-number">3</span> Main App</a><ul>
<li><a href="#application-state-and-reading-this-manual"><span class="toc-section-number">3.1</span> Application state and reading this manual</a></li>
<li><a href="#interactive-phewas-manhattan-plot"><span class="toc-section-number">3.2</span> Interactive Phewas Manhattan Plot</a><ul>
<li><a href="#purpose"><span class="toc-section-number">3.2.1</span> Purpose</a></li>
<li><a href="#whats-shown"><span class="toc-section-number">3.2.2</span> What’s Shown</a></li>
<li><a href="#filtering-codes"><span class="toc-section-number">3.2.3</span> Filtering codes</a></li>
<li><a href="#app-interaction"><span class="toc-section-number">3.2.4</span> App Interaction</a></li>
</ul></li>
<li><a href="#comorbidity-upset-plot"><span class="toc-section-number">3.3</span> Comorbidity Upset Plot</a><ul>
<li><a href="#purpose-1"><span class="toc-section-number">3.3.1</span> Purpose</a></li>
<li><a href="#whats-shown-1"><span class="toc-section-number">3.3.2</span> What’s Shown</a></li>
<li><a href="#app-interaction-1"><span class="toc-section-number">3.3.3</span> App Interaction</a></li>
</ul></li>
<li><a href="#info-panel"><span class="toc-section-number">3.4</span> Info Panel</a><ul>
<li><a href="#purpose-2"><span class="toc-section-number">3.4.1</span> Purpose</a></li>
<li><a href="#whats-shown-2"><span class="toc-section-number">3.4.2</span> What’s Shown</a></li>
<li><a href="#app-interaction-2"><span class="toc-section-number">3.4.3</span> App Interaction</a></li>
</ul></li>
<li><a href="#subject-phecode-bipartite-network"><span class="toc-section-number">3.5</span> Subject-Phecode Bipartite Network</a><ul>
<li><a href="#purpose-3"><span class="toc-section-number">3.5.1</span> Purpose</a></li>
<li><a href="#whats-shown-3"><span class="toc-section-number">3.5.2</span> What’s shown</a></li>
<li><a href="#app-interaction-3"><span class="toc-section-number">3.5.3</span> App Interaction</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<div class="main">
<style type="text/css">
body {
  font-size: 13px;
}
</style>
<div id="data" class="section level1">
<h1><span class="header-section-number">1</span> Data</h1>
<p>In order to use the app you will need three tables of data: two sets of individual-level data and one model results table. If using the app in data loading mode these are provided as <code>.csv</code> files.</p>
<div id="individual-phenomes" class="section level2">
<h2><span class="header-section-number">1.1</span> Individual phenomes</h2>
<p>The first set of individual data you will need is a table containing pairs of patient-id to phecode-id (or ICD9/ICD10). This table is just two columns, so a patient <code>p1</code> with phecodes <code>a</code>, <code>b</code>, and <code>c</code> would have three lines in the table, <code>p1, a</code>, <code>p1, b</code>, and <code>p1, c</code>.</p>
<p>The patient id column should be titled either <code>grid</code>, <code>id</code>, or <code>iid</code> (case insensitive) and the phenotype id column should be titled <code>code</code>.</p>
</div>
<div id="individual-snp-info" class="section level2">
<h2><span class="header-section-number">1.2</span> Individual SNP info</h2>
<p>The next set of individual data comes in the form of presence of the minor allele for each patient. Again the table is two columns, with the first being patient-id and the second being the integer (<code>0,1</code>, or <code>2</code>) corresponding to how many copies of the minor allele the patient had. (Note that it is possible to omit rows for patients with no copies of the minor allele and the application will assume those patients had zero copies. Like the individual phenomes table, the title of the patient id needs to be <code>grid</code>, <code>id</code>, or <code>iid</code>, and the title of the second column should be the rsid of the SNP of interest, which the app uses to infer the SNP id.</p>
</div>
<div id="phewas-results" class="section level2">
<h2><span class="header-section-number">1.3</span> PheWas results</h2>
<p>The last set of data needed is the results of the PheWas study you wish to analyze. This takes the form of a table with the following columns.
- <code>code</code>: PheCode, ICD9, or ICD10 code
- <code>OR</code>: Odds ratio for test with SNP
- <code>p_val</code>: P-Value for significance of code’s association
- <code>description</code>: The plain text description of the code
- <code>category</code>: Plain text description of code’s broad-level category.</p>
<p>Any other columns included will be displayed in the app as additional information when investigating a single SNP via tooltips, but is not necessary.</p>
</div>
<div id="app-api" class="section level2">
<h2><span class="header-section-number">1.4</span> App API</h2>
<p>If you are starting an ME application with preloaded data from the R package API, the format of these files remains almost the same, with the exception being R dataframes are passed directly to the function <code>build_me_app()</code>. For more detailed information see the application documentation either in the ‘reference’ tab of this website or by accessing the package documentation in your R console with <code>?meToolkit:: build_me_app</code>.</p>
</div>
<div id="data-loading-screen" class="section level2">
<h2><span class="header-section-number">1.5</span> Data Loading Screen</h2>
<p><img src='manual_figures/loading_page.png' width=100% /></p>
<p>When the app is first loaded the user is greeted by the data-loading screen. This screen prompts the user to provide the three previously described datasets as CSV’s or choose from available preloaded data (see next section for how to prepare this data.)</p>
<p>As each file is uploaded the app will check to make sure the files match the required format and inform the user of malformed data if it is uploaded.</p>
<p>Once all data is loaded, the user is automatically sent to the main dashboard.</p>
</div>
<div id="preloading-data" class="section level2">
<h2><span class="header-section-number">1.6</span> Preloading data</h2>
<p>If a set of results are going to be repeatedly visited in the app, the data for the results can be preloaded to save time. Once data is preloaded it populates a dropdown menu on the data-loading screen that can be used to select the desired dataset.</p>
<p>To do this, the data must be loaded into a path (relative to the main app working directory) provided to <code>run_data_loader()</code> in the <code>preloaded_data_path</code> argument . The patient phenome file must be stored at <code>preloaded_data_loc/id_to_code.csv</code>, and each individual SNP’s patient-to-snp and phewas results stored in <code>preloaded_data_loc/&lt;SNP_ID&gt;/id_to_snp.csv</code> and <code>preloaded_data_loc/&lt;SNP_ID&gt;/phewas_results.csv</code> respectively.</p>
<p><em>Note that due to sharing the same phenome mappings, all preloaded phewas results must be done on the same population.</em></p>
</div>
</div>
<div id="accessing-app" class="section level1">
<h1><span class="header-section-number">2</span> Accessing app</h1>
<p>There are two main ways to access Multimorbidity Explorer.</p>
<p><strong>Hosted</strong>
The first is to go to the hosted example at prod.tbilab.org/multimorbidity_explorer. Here you can run the app on preloaded simulated data or upload your own data. No uploaded data is saved on the hosting server.</p>
<p><strong>Self-Hosting</strong>
If data privacy is a concern, the app can be run entirely locally on any computer with R installed and the ability to install packages. To run locally install the <code>meToolkit</code> package from github using the <code>devtools</code> package…</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&#39;tbilab/meToolkit&#39;</span>)</a></code></pre></div>
<p>Once the package is installed the app can be launched with the data loading interface using the command</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">meToolkit<span class="op">::</span><span class="kw">build_me_w_loader</span>()</a></code></pre></div>
<p><strong>Customizing with R API</strong>
The <code>meToolkit</code> package is setup modularly so the data loading page can be skipped if data is provided directly to the app via the function <code>meToolkit::build_me_app()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">my_ME_app &lt;-<span class="st"> </span><span class="kw">build_me_app</span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  phewas_table,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  id_to_snp,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  phenotype_id_pairs</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">)</a></code></pre></div>
<p>The data format for <code>phewas_table</code>, <code>id_to_snp</code>, and <code>phenotype_id_pairs</code> follows exactly from the required input files as outlined in <a href="#Data">the Data section</a></p>
<p>For further information on customizing applications read the packages documentation at prod.tbilab.org/meToolkit.</p>
</div>
<div id="main-app" class="section level1">
<h1><span class="header-section-number">3</span> Main App</h1>
<p><img src='manual_figures/main_dashboard.png' width=100% /></p>
<div id="application-state-and-reading-this-manual" class="section level2">
<h2><span class="header-section-number">3.1</span> Application state and reading this manual</h2>
<p>The state of the app is primarily driven by the list of currently selected phenotypes. At load this is small number of the most significant results from the Phewas analysis, but by interacting with the application the user changes this state.</p>
<p>Other state information includes, subjects that are to be highlighted or phenotypes that are to be ‘inverted’ (see ‘Subject-Phecode Bipartite Network’ section for details.)</p>
<p>Throughout the following sections the functionality of each panel of the dashboard is broken into two parts: what the panel shows and how interactivity works within the context of the panel, along with how that panel can interact with the main application state (the <strong>App Interaction</strong>) subsection for each panel.</p>
<p>The application state is saved in the URL of the page. To return to a pre-determined view, simply bookmark or copy the current URL. For apps with data loading screen, the state will automatically select the correct snp from preloaded data if it is available.</p>
</div>
<div id="interactive-phewas-manhattan-plot" class="section level2">
<h2><span class="header-section-number">3.2</span> Interactive Phewas Manhattan Plot</h2>
<p><img src='manual_figures/manhattan_plot.png' width=100% /></p>
<div id="purpose" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Purpose</h3>
<p>Visualizing results of entire Phewas analysis in graphical and table format and select codes to investigate comorbidities.</p>
</div>
<div id="whats-shown" class="section level3">
<h3><span class="header-section-number">3.2.2</span> What’s Shown</h3>
<p><strong>Manhattan Plot</strong>
The Interactive Phewas Manhattan plot contains a standard manhattan plot, which is a scatter plot with the x-axis containing each phecode tested for association with the SNP of interest, and the y-axis representing the p-value of the association (on the negative log base-10 scale.)</p>
<p>The points are colored according to the broadly provided code <code>category</code> in the Phewas results table.</p>
<p>The plot contains a few features not normally found on manhattan plots. First, the points themselves are either hollow or solid, corresponding to a negative association (<code>OR</code> &lt; 1) or positive association (<code>OR</code> &gt; 1) respectively. This allows the viewer to get an idea of general trends in association by category and subcodes.</p>
<p>Hovering over a given Phecode in the plot will show a tooltip containing all the information passed to the app in the Phewas results data (Odds ratio, p-value, ect.).</p>
<p><strong>Odds Ratio Histogram</strong>
In addition to showing positive and negative association in point shape, a histogram of the log-odds ratio of all tests is provided below the manhattan plot. This plot allows the viewer to see the broad distribution of associations with the SNP of interest.</p>
<p>A range selector is overlaid. This can be dragged to control which points are shown in the manhattan plot based upon their odds ratio. E.g. if the histogram upper range is reduced to a log odds ratio of 0, only phecodes that had a negative association would be plotted on the manhattan plot. This allows the viewer to target phenotypes based on effect size.</p>
<p><strong>Phewas Table</strong>
Below the manhattan plot and odds ratio histogram is a table corresponding to all the provided results. This table contains columns for the code name, odds ratio, p-value, code description, and code category. The table can be sorted by all column values in addition to being searched for both code name and description.</p>
</div>
<div id="filtering-codes" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Filtering codes</h3>
<p><strong>Manhattan Plot</strong>
Codes can be selected in a variety of ways. The main method of interaction involves dragging a box around a region of codes on the manhattan plot. A common case is to select the top most significant codes by dragging a box across the upper portion of the plot.</p>
<p>There are two keyboard shortcuts that can modify drag-selection behavior. First, if the ‘a’ key is held down (for __a__dd) while the selection box is drawn, the selection is added to any previously selected codes. This can be useful if two distinct regions of the manhattan plot are desired, potentially corresponding to two categories of interest. Second, if the ‘d’ key is held down (for __d__elete), any newly selected codes will be removed from the selection. This can help fine tune selections without needing to redraw the entire region.</p>
<p>Individual codes can be selected and unselected with a click.</p>
<p>Any codes outside of the current odds ratio bounds set by the histogram range-slider are not able to be selected.</p>
<p><strong>Phewas Table</strong>
Codes can be either added or removed from the selection by clicking on their row in the Phewas table. Codes that are currently selected are colored orange.</p>
</div>
<div id="app-interaction" class="section level3">
<h3><span class="header-section-number">3.2.4</span> App Interaction</h3>
<p>Once a selection of codes has been made, pressing the ‘Update Network’ button in the upper right of the panel will update the rest of the app with the current selection of codes.</p>
<p><strong>Reset Button</strong>
The reset button allows the user undo all code changes they have made since the last app-update. I.e. loading state or the last time the app-wide state of selected codes was changed.</p>
</div>
</div>
<div id="comorbidity-upset-plot" class="section level2">
<h2><span class="header-section-number">3.3</span> Comorbidity Upset Plot</h2>
<p><img src='manual_figures/upset_plot.png' width=100% /></p>
<div id="purpose-1" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Purpose</h3>
<p>To visualize unique comorbidity patterns in currently selected Phecodes, along with those pattern’s associations with the SNP of interest.</p>
</div>
<div id="whats-shown-1" class="section level3">
<h3><span class="header-section-number">3.3.2</span> What’s Shown</h3>
<p>The Comorbidity Upset Plot is an <a href="https://caleydo.org/tools/upset/">Upset plot</a> that visualizes unique combinations of Phecodes seen in the subjects.</p>
<p><strong>Pattern Matrix</strong>
The center of the visualization contains a matrix with the currently selected phecodes as columns and unique patterns of those phecodes seen in the individual-level data as the rows. A pattern is represented by a dot being filled in at each column corresponding to a code in the pattern. These dots are colored by the category of the phenotype.</p>
<p>A toggle is provided to hide patterns that consist of only a single phecode. Singleton patterns can dominate the plot due to how common they are, so filtering them out can allow for closer inspection of comorbidity patterns.</p>
<p><strong>Marginal Counts</strong>
At the top of each Phecode column in the plot is a bar representing how many subjects had that code in the data. These bars can be hovered over to get a text-summary.</p>
<p><strong>Pattern Counts</strong>
At the left side of each pattern row, another bar is drawn corresponding to how many patients had that specific pattern in the data. (Note that if a pattern is a subset of another, the bar represents that subjects that <em>only</em> had exactly the smaller pattern.) Below the x-axis of the pattern-counts bars is a handle that can be moved to change the threshold for minimum number of times seen needed for a pattern to be plotted. This is helpful when there are a large number of unique patterns but only ones with large sample sizes are of interest. By increasing the threshold needed for inclusion the plot is ‘zoomed’ in on the more common patterns. Like with the marginal bars, more info is available in text form on hover over the patterns.</p>
<p><strong>Relative Risk Estimates</strong>
To the right of each pattern’s row is a point estimate and 95% confidence band of the relative risk of that pattern occurring given presence of at least one copy of the SNP of interest. This is estimated using the small sample adjustment for both point estimate and confidence interval, via the function <code>riskratio.small</code> in the <a href="https://cran.r-project.org/web/packages/epitools/epitools.pdf"><code>epitools</code> package</a>.</p>
<p>Again, hovering over the interval shows details of plot in text format.</p>
</div>
<div id="app-interaction-1" class="section level3">
<h3><span class="header-section-number">3.3.3</span> App Interaction</h3>
<p>The upset plot can highlight individual-level data in the network plot. There are two forms this highlighting takes.</p>
<p><strong>Code Highlighting</strong>
By clicking on a column corresponding to a given code, all subjects that have that code present in their phenomes will be highlighted on the network plot. This means if subject A had a phenome with codes <em>i</em> and <em>j</em>, and subject B had a phenome with codes <em>i</em>, <em>j</em>, and <em>k</em>, both would be highlighted when code i or j’s columns were selected.</p>
<p><strong>Pattern Highlighting</strong>
By clicking on a row corresponding to a given comorbidity pattern of codes, all subjects who possess that <em>exact</em> pattern in their phenomes will be selected. Returning to the example in the ‘Code Highlighting’ section, this means if the pattern of phecodes (<em>i</em>, <em>j</em>) was selected <em>only</em> subject A would be highlighted.</p>
<p>Highlights for both codes and patterns are reset when either another pattern is selected of the column/row is selected again.</p>
</div>
</div>
<div id="info-panel" class="section level2">
<h2><span class="header-section-number">3.4</span> Info Panel</h2>
<p><img src='manual_figures/info_panel.png' width=100% /></p>
<div id="purpose-2" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Purpose</h3>
<p>Show information about the current SNP of Interest including minor allele frequency and basic annotations, along with usage instructions for application.</p>
</div>
<div id="whats-shown-2" class="section level3">
<h3><span class="header-section-number">3.4.2</span> What’s Shown</h3>
<p>The info panel is broken into three main sections…</p>
<p><strong>Minor Allele Frequencies</strong>
The top of the panel shows two measures of the minor allele frequency (MAF) for the current SNP of interest. The first of two bars shows the MAF for the entire dataset provided for the app. I.e. what proportion of all subjects provided have at least one copy of the minor allele. The second bar shows the MAF for the subjects who have at least one of the currently selected phecodes.</p>
<p><strong>SNP Annotations</strong></p>
<p>Below the MAF chart is a table containing annotations about the current SNP. Currently these include SNP name, chromosome, gene SNP resides in, minor allele, Exome Aggregation Consortium (ExAC) minor allele frequency, clinical significance, consequence, impact, symbol, gene id, and HGVSp for SNPS found on the <a href="https://www.illumina.com/products/by-type/microarray-kits/infinium-exome.html">Illumina Exome chip</a>.</p>
<p><strong>Instructions</strong>
This panel contains basic instructions on how to use the application.</p>
</div>
<div id="app-interaction-2" class="section level3">
<h3><span class="header-section-number">3.4.3</span> App Interaction</h3>
<p>The info panel has no app-level state interaction capabilities.</p>
</div>
</div>
<div id="subject-phecode-bipartite-network" class="section level2">
<h2><span class="header-section-number">3.5</span> Subject-Phecode Bipartite Network</h2>
<p><img src='manual_figures/network_plot.png' width=100% /></p>
<div id="purpose-3" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Purpose</h3>
<p>Provide a direct look at individual-level data, showing connections between subjects and their phecodes along with the status for the SNP of interest.</p>
</div>
<div id="whats-shown-3" class="section level3">
<h3><span class="header-section-number">3.5.2</span> What’s shown</h3>
<p><strong>The Network Components</strong>
The network is bipartite, with two different node types. The larger nodes correspond to the currently selected Phecodes, colored by their category as in the Manhattan and Upset plots. The smaller nodes represent individual subjects, colored by their number of copies of the minor allele for the SNP of interest. Edges are drawn from each subject to all the Phecodes present in their Phenome.</p>
<p><strong>Layout</strong>
The layout of the network is calculated in real time using a basic physics simulation that treats the edges of the network as springs and tries to find the layout with the lowest total tension in the system. This serves to place similar patients and phecodes near each other and acts as a pseudo-dimensionality-reduction technique.</p>
<p><strong>Interaction</strong>
The network can be panned and zoomed to focus in on subsections or to zoom out for a broader picture. A toggle is provided draw the network with only subjects possessing at least one copy of the minor allele, as a way to investigate differences in overall vs SNP-driven structure.</p>
<p>Like in the Interactive Phewas Manhattan plot, by mousing over a phecode’s node a tooltip is revealed with all the supplied information from supplied Phewas results data.</p>
<p><strong>Export Mode</strong>
The network plot can be exported in SVG format for use in vector-editing software such as Adobe Illustrator or Inkscape to prepare for publication.</p>
<p>Export is enabled by clicking the ‘Export mode’ button in the bottom right of the plot. This re-renders the plot in vector format and also provides the option to add callouts labeling each Phecode by ID. These callouts are able to be positioned by dragging.</p>
<p>Once the plot has been customized as desired and the download icon is pressed, an SVG of the current view is downloaded to the user’s local computer.</p>
<p>Due to the computational overhead of rendering the network in vector format, it is recommended that export mode is kept off until needed to avoid slowing down the app.</p>
</div>
<div id="app-interaction-3" class="section level3">
<h3><span class="header-section-number">3.5.3</span> App Interaction</h3>
<p>The network plot can be used to fine-tune the app-wide selected Phecodes. This is done by clicking or tapping on a Phecode node in the network to select it. Once at least one node is selected an action menu appears in the lower left of the plot. Here the user can choose to remove the selected code(s), to isolate a pattern of selected codes, or to ‘invert’ a code.</p>
<p><strong>Code Inversion</strong>
When a code is inverted a subject is considered to ‘have’ the code if it is absent in their phenome. Visually in the network this is represented as a hollow node. By inverting a code you can frame questions in terms of negative relationships, potentially uncovering previously unseen relationships.</p>
</div>
</div>
</div>
</div>



<script>
// when the page is about to reload via servr, remember the scroll position
document.addEventListener('servr:reload', function(e) {
  sessionStorage.setItem('pagedown-scroll', window.scrollY);
});
</script>
</body>
</html>
